---
title: Conducting a Malware Analysis
date: 2022-11-26 09:45:00 +/-TTTT
categories: [security, blue-team]
tags: [malware-analysis] # TAG names should always be lowercase
---

When it comes to cyber threats, malware is one of the most common and insidious. Whether it’s a cookie, macro, or even a word document, malware can lurk in any file type. In fact, some malware is so well camouflaged that you won’t know its malicious until it’s already on your computer. Fortunately, there are security professionals with the knowledge and experience to spot potential dangers before they become real problems. A thorough malware analysis is essential for every organization with sensitive data or systems accessible from external networks. However, this is one of the more technical security measures that requires special attention to detail and system processes to be effective.

## Plan before you dive in

Before you open an infected file, you should know what you’re looking for. That means first determining the file type, then discovering what its particular purpose is. The first step is to use file identification software to determine the file type. There are several programs you can use, but you want one that’s easy to use and can provide detailed information. Depending on the file type, you may need to use other identification or analysis software. You’ll also want to know the following: What is the file’s purpose? What is the file’s size? What is the file’s MD5 hash (used to identify unique files)? What are the file’s strings (letters, words, and symbols in the code)? What does the file’s metadata reveal?

## Acquire the suspect file(s)

Collect a sample of the suspect file(s) using a tool designed to acquire files without altering their original content. This will help ensure that you don’t make any changes to the file that might alter its true purpose or condition. Once the file is acquired, you’ll want to create a sandbox or virtual environment where the file can be safely examined without altering or damaging your computer or network. The sandbox allows you to run programs as if you were at a computer, but it’s isolated from your computer’s operating system. Depending on the file type, you may need to use more than one of these sandboxes, and you may need to modify the sandboxes with special software to make sure the file is able to run.

## Preliminary analysis

Once the file is in its sandbox, you’ll want to conduct a preliminary analysis. Use the same identification software you used before, but pay special attention to any anomalies that might indicate that the file is hiding something malicious. You’ll also want to examine the file’s strings and metadata to see if they contain anything unusual or malicious. You can usually do this by copying and pasting the file into a text editor and looking at the “raw” data.

## Examining the file’s behavior

Did you notice any unusual or malicious behavior from the file during the identification and preliminary analysis? If so, you should try to simulate the file’s normal behavior to see if anything seems out of the ordinary. This can be as simple as opening the file and seeing where the file takes you. Does the file make odd network requests? Are there any DNS requests coming from the file? If so, you’ll want to conduct network and DNS analysis to determine what the file is trying to do. This will help you determine if the file is simply trying to communicate with another computer, or if it’s trying to communicate with another computer to download malicious code or content. Later on, You can also run the file through a debugger or disassembler to see how the file’s code works.

## Taking actions

Now that you’ve examined the file’s behavior, it’s time to take action. Depending on the results of your analysis, you’ll want to take a number of different actions, such as blocking or deleting the malware or alerts, updating your antivirus software, or blocking network traffic to the malicious IP addresses. If the malware is detected by your antivirus software, you should run an analysis to determine its severity. You can use the antivirus software’s reporting tool to create a report for the malware. When creating the report, make sure you include the sample that you collected and the detection results from the antivirus software. If the malware is not detected by your antivirus software, you’ll want to alert your organization’s security team by creating a ticket with all the information you’ve gathered, such as where the malware is located, what it does, and the IP addresses it contacted.

## Summing up

Malware analysis is a crucial security measure for any organization with sensitive data or systems accessible from external networks. The best way to protect your systems from malware is to understand how it works and how it gets there. A thorough malware analysis requires several steps, including determining the file type, conducting a preliminary analysis, simulating the file’s normal behavior, and running the file through a debugger or disassembler to see how its code works. Once you understand how malware works, you can better protect your systems from attacks and know when you’ve been compromised.
